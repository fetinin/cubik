# Yeelight WiFi Light Inter-Operation Specification

**Source**: [www.yeelight.com](https://www.yeelight.com)

## Table of Contents

1. [Introduction](#introduction)
2. [Overview](#overview)
3. [Local Discovery](#local-discovery)
   - [Search Request and Response](#search-request-and-response)
   - [Advertisement](#advertisement)
4. [Control Protocol](#control-protocol)
   - [COMMAND Message](#command-message)
   - [RESULT Message](#result-message)
   - [NOTIFICATION Message](#notification-message)
5. [Issues and Future Consideration](#issues-and-future-consideration)
6. [Reference](#reference)

## Introduction

Yeelight smart LED products support remote control through WiFi. When a user receives a smart LED device for the first time, they need to complete a configuration procedure to provision the router's SSID and password to the device. This procedure is normally called SmartConfig or QuickConnect. Due to security considerations, the protocol used for SmartConfig is proprietary, which means no 3rd party can know about it or use it.

However, after the device is connected to the router, it can be seen by all devices under the same network and can be controlled by 3rd party equipment that understands the inter-operation control protocol.

The purpose of this document is to help:
- 3rd party equipment vendors that want to work with Yeelight smart devices
- Users who are willing to play with the device using their own software

This document explains the technical details of discovering and controlling the device.

## Overview

Currently, Yeelight WiFi LED is controlled through the cloud. The command is sent to a cloud server and then forwarded to the device.

All WiFi LEDs maintain a connection with the cloud server. If the cloud server is down or the WAN network experiences issues, users will lose control of the device. Therefore, local control is necessary and this specification defines the local control mechanism.

Local control is divided into two parts:
1. **Discovery procedure** - Uses a simplified SSDP-like protocol
2. **Control procedure** - Uses JSON-formatted control commands

These two parts are explained in detail in sections 3 and 4.

## Local Discovery

As defined in SSDP, there are two kinds of discovery messages:
- **Searching messages** - Used by devices that want to find other devices or services
- **Advertising messages** - Used by devices willing to announce their presence on the network

Yeelight smart LEDs support both kinds of messages. The device listens on a multicast address for incoming search requests. If the request is targeted for Yeelight smart LED (ST header contains the Yeelight pre-defined value), the device will unicast a response to the searcher.

The response contains basic information about the device:
- IP and port of the control service
- Current power status
- Current brightness
- All supported control methods

The advertising message is sent by the Yeelight smart LED after it joins the network or after a fixed period of time to refresh its state. The message is sent to a multicast address with basic information. The receiver should not respond to the advertisement.

**Important**: Unlike the standard SSDP protocol, multicast messages are sent to port **1982** instead of port 1900. This avoids excessive multicast messages being received by both smart LEDs and 3rd party devices, which is especially important for power-consumption-sensitive devices (e.g., battery-powered smart watches).

### Search Request and Response

#### Search Request Format

The searching message generated by a 3rd party device should follow this format and be sent to multicast address `239.255.255.250:1982` over UDP:

```
M-SEARCH * HTTP/1.1
HOST: 239.255.255.250:1982
MAN: "ssdp:discover"
ST: wifi_bulb
```

**Rules:**
1. The start line must be `M-SEARCH * HTTP/1.1` without any leading LWS (linear white space)
2. `HOST` header is optional; if present, the value should be `239.255.255.250:1982`
3. `MAN` header is required; value must be `"ssdp:discover"` (double quotes included)
4. `ST` header is required; value must be `wifi_bulb`
5. Headers are case-insensitive, but the start line and header values are case-sensitive
6. Each line should be terminated by `\r\n`

Any message that doesn't follow these rules will be silently dropped, meaning the searching device won't be able to find any Yeelight smart LED.

#### Search Response Format

If the message is deemed valid, the response message will be generated by the Yeelight smart LED and unicasted to the request sender's sending IP and port. For example, if the request is sent by `192.168.1.22` on UDP port `43210`, the response will be sent to `192.168.1.22:43210`.

```
HTTP/1.1 200 OK
Cache-Control: max-age=3600
Date:
Ext:
Location: yeelight://192.168.1.239:55443
Server: POSIX UPnP/1.0 YGLC/1
id: 0x000000000015243f
model: color
fw_ver: 18
support: get_prop set_default set_power toggle set_bright start_cf stop_cf set_scene cron_add cron_get cron_del set_ct_abx set_rgb
power: on
bright: 100
color_mode: 2
ct: 4000
rgb: 16711680
hue: 100
sat: 35
name: my_bulb
```

#### Response Headers

**Standard Headers:**
- **Start line**: Always `HTTP/1.1 200 OK`
- **CACHE-CONTROL**: Contains the status refresh interval in seconds
- **LOCATION**: Contains the service access point. URI scheme is always `yeelight`, host is the IP address, port is the TCP listen port
- **DATE**, **EXT**, **SERVER**: Included to conform with SSDP, no critical information

**Yeelight-Specific Headers:**

| Header | Description |
|--------|-------------|
| `id` | Unique ID of the device (use this to uniquely identify a Yeelight WiFi LED device) |
| `model` | Product model: `mono`, `color`, `stripe`, `ceiling`, `bslamp` <br>- `mono`: brightness adjustment only<br>- `color`: color and color temperature adjustment<br>- `stripe`: LED stripe<br>- `ceiling`: Ceiling light<br>- `bslamp`: Bedside lamp |
| `fw_ver` | Firmware version |
| `support` | All supported control methods separated by spaces. 3rd party devices can use this to dynamically render the control view. Any control request invoking a method not in this field will be rejected |
| `power` | Current power status: `on` or `off` (software-managed, not unpowered) |
| `bright` | Current brightness percentage (1-100) |
| `color_mode` | Current light mode:<br>- `1`: Color mode<br>- `2`: Color temperature mode<br>- `3`: HSV mode |
| `ct` | Current color temperature value (product-dependent range). Only valid if `color_mode` is `2` |
| `rgb` | Current RGB value. Only valid if `color_mode` is `1` |
| `hue` | Current hue value (0-359). Only valid if `color_mode` is `3` |
| `sat` | Current saturation value (0-100). Only valid if `color_mode` is `3` |
| `name` | Device name (set via `set_name`, max 64 bytes). For non-ASCII characters, BASE64 encoding is recommended |

**Note**: HUE and SAT should be used in combination. CT mode, RGB mode, and HSV mode are mutually exclusive.

#### Recommended Actions After Receiving Response

1. Parse and validate the response message
2. Identify the device by checking if it exists in local storage (search by ID)
3. Display the status to the user if necessary
4. Use the information in the `LOCATION` header to establish a TCP connection
5. After successful TCP connection, send control messages or monitor status changes

### Advertisement

Right after a Yeelight smart LED joins the local network, it announces its presence by multicasting an advertisement request. This notifies 3rd party devices that the smart LED is online and ready to serve control requests. Without this, 3rd party devices would need to probe the network periodically, which is power-consuming and inefficient.

After the initial announcement, the Yeelight smart LED refreshes its state by sending advertisement messages at fixed intervals.

#### Advertisement Message Format

```
NOTIFY * HTTP/1.1
Host: 239.255.255.250:1982
Cache-Control: max-age=3600
Location: yeelight://192.168.1.239:55443
NTS: ssdp:alive
Server: POSIX, UPnP/1.0 YGLC/1
id: 0x000000000015243f
model: color
fw_ver: 18
support: get_prop set_default set_power toggle set_bright start_cf stop_cf set_scene cron_add cron_get cron_del set_ct_abx set_rgb
power: on
bright: 100
color_mode: 2
ct: 4000
rgb: 16711680
hue: 100
sat: 35
name: my_bulb
```

**Headers:**
- **Start line**: Always `NOTIFY * HTTP/1.1`
- **NTS**: Always `ssdp:alive`
- **CACHE-CONTROL**: Status refresh interval in seconds
- **LOCATION**: Service access point (same format as search response)
- All Yeelight-specific headers are the same as in the search response (see section 3.1)

#### Recommended Actions After Receiving Advertisement

1. Parse and validate the message
2. Identify the device by checking if it exists in local storage (search by ID)
3. If device exists, refresh its state and display to user
4. If device is new, present the new device to user
5. Use the information in the `LOCATION` header to establish a TCP connection
6. After successful TCP connection, send control messages or monitor status changes

## Control Protocol

After the local discovery procedure is completed, a control plane can be established between 3rd party devices and smart LEDs. This carries control protocol messages encoded in JSON format.

Yeelight smart LED control protocol defines 3 types of messages:
1. **COMMAND message** - Sent by 3rd party devices to control the LED
2. **RESULT message** - Response from the LED
3. **NOTIFICATION message** - Spontaneous updates from the LED

All messages must be delivered in defined JSON format on a TCP connection, and each individual message must be terminated by `\r\n`.

**Debugging Tip**: If you know the IP of the smart LED, you can use telnet to establish the control channel:
```bash
telnet <IP> 55443
```
This is helpful for debugging and troubleshooting during development.

### Connection Limits

- **Maximum simultaneous TCP connections**: 4 (further connection attempts will be rejected)
- **Command quota per connection**: 60 commands per minute
- **Total quota for all LAN commands**: 144 commands per minute (4 × 60 × 60%)

### COMMAND Message

COMMAND messages are generated by 3rd party devices and sent to the smart LED.

#### Format

```json
{"id": <integer>, "method": "<method_name>", "params": [<param1>, <param2>, ...]}\r\n
```

| Field | Required | Type | Description |
|-------|----------|------|-------------|
| `id` | Yes | Integer | Request ID filled by sender, will be echoed back in RESULT message to correlate request and response |
| `method` | Yes | String | Control method to invoke, must be from the `support` field in discovery response |
| `params` | Yes | Array | Method-specific parameters |

**Example:**
```json
{"id": 1, "method": "set_power", "params": ["on", "smooth", 500]}
```

### Supported Methods

| Method | Param Count | Param 1 | Param 2 | Param 3 | Param 4 |
|--------|-------------|---------|---------|---------|---------|
| `get_prop` | 1 ~ N | property names | | | |
| `set_ct_abx` | 3 | int(ct_value) | string(effect) | int(duration) | |
| `set_rgb` | 3 | int(rgb_value) | string(effect) | int(duration) | |
| `set_hsv` | 4 | int(hue) | int(sat) | string(effect) | int(duration) |
| `set_bright` | 3 | int(brightness) | string(effect) | int(duration) | |
| `set_power` | 3-4 | string(power) | string(effect) | int(duration) | int(mode) |
| `toggle` | 0 | | | | |
| `set_default` | 0 | | | | |
| `start_cf` | 3 | int(count) | int(action) | string(flow_expression) | |
| `stop_cf` | 0 | | | | |
| `set_scene` | 3 ~ 4 | string(class) | int(val1) | int(val2) | int(val3) |
| `cron_add` | 2 | int(type) | int(value) | | |
| `cron_get` | 1 | int(type) | | | |
| `cron_del` | 1 | int(type) | | | |
| `set_adjust` | 2 | string(action) | string(prop) | | |
| `set_music` | 1 ~ 3 | int(action) | string(host) | int(port) | |
| `set_name` | 1 | string(name) | | | |
| `adjust_bright` | 2 | int(percentage) | int(duration) | | |
| `adjust_ct` | 2 | int(percentage) | int(duration) | | |
| `adjust_color` | 2 | int(percentage) | int(duration) | | |
| `dev_toggle` | 0 | | | | |

**Background Light Methods** (for devices with background light):
- `bg_set_rgb`, `bg_set_hsv`, `bg_set_ct_abx`, `bg_start_cf`, `bg_stop_cf`
- `bg_set_scene`, `bg_set_default`, `bg_set_power`, `bg_set_bright`
- `bg_set_adjust`, `bg_toggle`, `bg_adjust_bright`, `bg_adjust_ct`, `bg_adjust_color`

---

### Method Details

#### `get_prop`

**Usage**: Retrieve current property of smart LED

**Parameters**: 1 to N property names

**Returns**: Array of corresponding property values. If a requested property is not recognized, an empty string (`""`) is returned.

**Example:**
```json
Request:  {"id": 1, "method": "get_prop", "params": ["power", "not_exist", "bright"]}
Response: {"id": 1, "result": ["on", "", "100"]}
```

**Note**: All supported properties are defined in Table 4-2, Section 4.3

---

#### `set_ct_abx`

**Usage**: Change the color temperature of a smart LED

**Parameters**:
- `ct_value` (integer): Target color temperature, range 1700-6500 (Kelvin)
- `effect` (string): `"sudden"` or `"smooth"`
  - `"sudden"`: Change directly to target value (duration ignored)
  - `"smooth"`: Change gradually over the duration period
- `duration` (integer): Total time for gradual change in milliseconds (minimum 30ms)

**Example:**
```json
Request:  {"id": 1, "method": "set_ct_abx", "params": [3500, "smooth", 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: Only accepted if the smart LED is currently in "on" state

---

#### `set_rgb`

**Usage**: Change the color of a smart LED

**Parameters**:
- `rgb_value` (integer): Target color, decimal integer 0-16777215 (hex: 0xFFFFFF)
- `effect` (string): `"sudden"` or `"smooth"` (see `set_ct_abx`)
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "set_rgb", "params": [255, "smooth", 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: Only accepted if the smart LED is currently in "on" state

---

#### `set_hsv`

**Usage**: Change the color of a smart LED using HSV

**Parameters**:
- `hue` (integer): Target hue value, range 0-359
- `sat` (integer): Target saturation value, range 0-100
- `effect` (string): `"sudden"` or `"smooth"` (see `set_ct_abx`)
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "set_hsv", "params": [255, 45, "smooth", 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: Only accepted if the smart LED is currently in "on" state

---

#### `set_bright`

**Usage**: Change the brightness of a smart LED

**Parameters**:
- `brightness` (integer): Target brightness percentage, range 1-100
- `effect` (string): `"sudden"` or `"smooth"` (see `set_ct_abx`)
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "set_bright", "params": [50, "smooth", 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: Only accepted if the smart LED is currently in "on" state

---

#### `set_power`

**Usage**: Switch on or off the smart LED (software-managed on/off)

**Parameters**:
- `power` (string): `"on"` or `"off"`
- `effect` (string): `"sudden"` or `"smooth"` (see `set_ct_abx`)
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)
- `mode` (integer, optional):
  - `0`: Normal turn on operation (default)
  - `1`: Turn on and switch to CT mode
  - `2`: Turn on and switch to RGB mode
  - `3`: Turn on and switch to HSV mode
  - `4`: Turn on and switch to color flow mode
  - `5`: Turn on and switch to Night light mode (Ceiling light only)

**Example:**
```json
Request:  {"id": 1, "method": "set_power", "params": ["on", "smooth", 500]}
Response: {"id": 1, "result": ["ok"]}
```

---

#### `toggle`

**Usage**: Toggle the smart LED on/off

**Parameters**: None

**Example:**
```json
Request:  {"id": 1, "method": "toggle", "params": []}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: Useful when you want to flip the state without knowing the current state

---

#### `set_default`

**Usage**: Save current state to persistent memory. When the device is power-cycled (hard reset), it will restore to this saved state.

**Parameters**: None

**Example:**
```json
Request:  {"id": 1, "method": "set_default", "params": []}
Response: {"id": 1, "result": ["ok"]}
```

**Note**:
- Use this to create a default initial state (e.g., save favorite color and brightness)
- Only accepted if the smart LED is currently in "on" state

---

#### `start_cf`

**Usage**: Start a color flow. A color flow is a series of smart LED visible state changes (brightness, color, or color temperature). This is the most powerful command. All recommended scenes (e.g., Sunrise/Sunset effect) are implemented using this method.

**Parameters**:
- `count` (integer): Total number of state changes before stopping. `0` means infinite loop
- `action` (integer): Action taken after flow stops
  - `0`: Recover to state before color flow started
  - `1`: Stay at the state when flow stopped
  - `2`: Turn off the smart LED after flow stopped
- `flow_expression` (string): Expression defining the state changing series

**Flow Expression Format**:

Each visible state change is a **flow tuple** with 4 elements: `[duration, mode, value, brightness]`

A flow expression is a series of flow tuples concatenated as a comma-separated string.

**Flow Tuple Elements:**
- `duration` (integer): Gradual change time or sleep time in milliseconds (minimum 50ms)
- `mode` (integer):
  - `1`: Color mode
  - `2`: Color temperature mode
  - `7`: Sleep mode
- `value` (integer):
  - RGB value when mode is `1`
  - CT value when mode is `2`
  - Ignored when mode is `7`
- `brightness` (integer): Brightness value, range 1-100 or `-1`
  - `-1`: Brightness is ignored (only color or CT change takes effect)
  - Ignored when mode is `7`

**Example:**
```json
Request: {"id": 1, "method": "start_cf", "params": [4, 2, "1000,2,2700,100,500,1,255,10,5000,7,0,0,500,2,5000,1"]}
Response: {"id": 1, "result": ["ok"]}
```

This example means:
1. Change CT to 2700K & maximum brightness gradually in 1000ms
2. Change color to red & 10% brightness gradually in 500ms
3. Stay at this state for 5000ms (sleep)
4. Change CT to 5000K & minimum brightness gradually in 500ms
5. After 4 changes, stop the flow and power off the smart LED

**Flow Logic (Pseudo-code):**
```
start_cf:
  cnt = 0
  while true:
    if flow_cnt != 0 and cnt >= flow_cnt:
      take_stop_action(flow_action)
      break
    tuple = get_next_flow_tuple()  # Flow tuples are in a circular list
    apply_effect(tuple)  # Change RGB/CT gradually or sleep
    cnt++
```

**Note**: Only accepted if the smart LED is currently in "on" state

---

#### `stop_cf`

**Usage**: Stop a running color flow

**Parameters**: None

**Example:**
```json
Request:  {"id": 1, "method": "stop_cf", "params": []}
Response: {"id": 1, "result": ["ok"]}
```

---

#### `set_scene`

**Usage**: Set the smart LED directly to a specified state. If the LED is off, it will turn on first and then apply the specified state.

**Parameters**:
- `class` (string): Scene class
  - `"color"`: Change to specified color and brightness
  - `"hsv"`: Change to specified HSV and brightness
  - `"ct"`: Change to specified color temperature and brightness
  - `"cf"`: Start a color flow
  - `"auto_delay_off"`: Turn on to specified brightness and start a sleep timer
- `val1`, `val2`, `val3`: Class-specific values

**Examples:**
```json
Color:     {"id": 1, "method": "set_scene", "params": ["color", 65280, 70]}
HSV:       {"id": 1, "method": "set_scene", "params": ["hsv", 300, 70, 100]}
CT:        {"id": 1, "method": "set_scene", "params": ["ct", 5400, 100]}
CF:        {"id": 1, "method": "set_scene", "params": ["cf", 0, 0, "500,1,255,100,1000,1,16776960,70"]}
Auto-off:  {"id": 1, "method": "set_scene", "params": ["auto_delay_off", 50, 5]}

Response:  {"id": 1, "result": ["ok"]}
```

**Example Explanations:**
1. Set color to 65280 and 70% brightness
2. Set color to Hue:300, Saturation:70, and max brightness
3. Set CT to 5400K and 100% brightness
4. Start an infinite color flow on two flow tuples
5. Turn on the light to 50% brightness and turn off after 5 minutes

**Note**: Accepted in both "on" and "off" states

---

#### `cron_add`

**Usage**: Start a timer job on the smart LED

**Parameters**:
- `type` (integer): Currently only `0` (power off)
- `value` (integer): Timer length in minutes

**Example:**
```json
Request:  {"id": 1, "method": "cron_add", "params": [0, 15]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**:
- Example: To start a sleep timer that turns off after 20 minutes: `{"id": 1, "method": "cron_add", "params": [0, 20]}`
- Only accepted if the smart LED is currently in "on" state

---

#### `cron_get`

**Usage**: Retrieve the setting of the current cron job

**Parameters**:
- `type` (integer): Type of cron job (currently only supports `0`)

**Example:**
```json
Request:  {"id": 1, "method": "cron_get", "params": [0]}
Response: {"id": 1, "result": [{"type": 0, "delay": 15, "mix": 0}]}
```

---

#### `cron_del`

**Usage**: Stop the specified cron job

**Parameters**:
- `type` (integer): Type of cron job (currently only supports `0`)

**Example:**
```json
Request:  {"id": 1, "method": "cron_del", "params": [0]}
Response: {"id": 1, "result": ["ok"]}
```

---

#### `set_adjust`

**Usage**: Change brightness, CT, or color without knowing the current value (mainly used by controllers)

**Parameters**:
- `action` (string): Direction of adjustment
  - `"increase"`: Increase the specified property
  - `"decrease"`: Decrease the specified property
  - `"circle"`: Increase the property, after reaching max value, go back to minimum
- `prop` (string): Property to adjust
  - `"bright"`: Adjust brightness
  - `"ct"`: Adjust color temperature
  - `"color"`: Adjust color (action can only be `"circle"`)

**Example:**
```json
Request:  {"id": 1, "method": "set_adjust", "params": ["increase", "ct"]}
Response: {"id": 1, "result": ["ok"]}
```

---

#### `set_music`

**Usage**: Start or stop music mode. Under music mode, no property will be reported and no message quota is checked.

**Parameters**:
- `action` (integer):
  - `0`: Turn off music mode
  - `1`: Turn on music mode
- `host` (string): IP address of the music server (required when action is `1`)
- `port` (integer): TCP port the music application is listening on (required when action is `1`)

**Examples:**
```json
Start:  {"id": 1, "method": "set_music", "params": [1, "192.168.0.2", 54321]}
Stop:   {"id": 1, "method": "set_music", "params": [0]}

Response: {"id": 1, "result": ["ok"]}
```

**Note**:
- When starting music mode, the control device must start a TCP server first, then call `set_music` to provide the IP and port
- The LED device will try to connect to the specified peer address
- If the TCP connection is established successfully, the control device can send all supported commands through this channel without limits to simulate any music effect
- Music mode can be stopped by sending a stop command or by closing the socket

---

#### `set_name`

**Usage**: Name the device. The name is stored on the device and reported in discovery responses. Can also be read via `get_prop`.

**Parameters**:
- `name` (string): Device name

**Example:**
```json
Request:  {"id": 1, "method": "set_name", "params": ["my_bulb"]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**:
- When using the official Yeelight App, the device name is stored on the cloud
- This method stores the name in the device's persistent memory
- The two names can be different

---

#### `adjust_bright`

**Usage**: Adjust brightness by specified percentage within specified duration

**Parameters**:
- `percentage` (integer): Percentage to adjust, range -100 to 100
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "adjust_bright", "params": [-20, 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: This command decreases brightness by 20% within 500 milliseconds

---

#### `adjust_ct`

**Usage**: Adjust color temperature by specified percentage within specified duration

**Parameters**:
- `percentage` (integer): Percentage to adjust, range -100 to 100
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "adjust_ct", "params": [20, 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: This command increases CT by 20% within 500 milliseconds

---

#### `adjust_color`

**Usage**: Adjust color within specified duration

**Parameters**:
- `percentage` (integer): Percentage to adjust, range -100 to 100 (parameter is ignored, color is internally defined)
- `duration` (integer): Duration in milliseconds (see `set_ct_abx`)

**Example:**
```json
Request:  {"id": 1, "method": "adjust_color", "params": [20, 500]}
Response: {"id": 1, "result": ["ok"]}
```

**Note**: The percentage parameter is ignored; the color is internally defined and cannot be specified

---

#### `dev_toggle`

**Usage**: Toggle both main light and background light at the same time

**Parameters**: None

**Note**:
- `toggle`: Toggles main light
- `bg_toggle`: Toggles background light
- `dev_toggle`: Toggles both lights simultaneously

---

#### Background Light Methods

**Usage**: Control background light (for devices equipped with background light)

**Methods**: `bg_set_rgb`, `bg_set_hsv`, `bg_set_ct_abx`, `bg_set_bright`, `bg_set_power`, `bg_start_cf`, `bg_stop_cf`, `bg_set_scene`, `bg_set_default`, `bg_set_adjust`, `bg_toggle`, `bg_adjust_bright`, `bg_adjust_ct`, `bg_adjust_color`

**Note**: These commands follow the same parameter format as their non-`bg_` counterparts. Refer to the corresponding method for details.

---

### RESULT Message

RESULT messages are generated by the smart LED upon receiving COMMAND messages. Every command should expect a result message containing the execution result or requested values.

#### Format

```json
{"id": <integer>, "result": [<values>]}\r\n
```

or

```json
{"id": <integer>, "error": {"code": <error_code>, "message": "<error_message>"}}\r\n
```

| Field | Required | Type | Description |
|-------|----------|------|-------------|
| `id` | Yes | Integer | Mirror of the `id` value in the COMMAND message |
| `result` | Conditional | Array | Returned if command executed successfully. Contains `["ok"]` or requested property values |
| `error` | Conditional | Object | Returned if command failed. Contains error details |

#### Examples

**Successful execution:**
```json
{"id": 1, "result": ["ok"]}
```

**Failed execution:**
```json
{"id": 2, "error": {"code": -1, "message": "unsupported method"}}
```

**Property query response:**
```json
Request:  {"id": 3, "method": "get_prop", "params": ["power", "bright"]}
Response: {"id": 3, "result": ["on", "100"]}
```

---

### NOTIFICATION Message

Whenever there is a state change of the smart LED, it sends a notification message to all connected 3rd party devices. This ensures all devices get the latest state in real-time without polling.

#### Format

```json
{"method": "props", "params": {<property>: "<value>", ...}}\r\n
```

| Field | Required | Type | Description |
|-------|----------|------|-------------|
| `method` | Yes | String | Currently only `"props"`. Other values should be deemed invalid |
| `params` | Yes | Object | Contains key-value pairs of changed properties. All values are strings |

#### Example

If the smart LED is switched on to 10% brightness:
```json
{"method": "props", "params": {"power": "on", "bright": "10"}}
```

---

### Supported Properties

| Property | Possible Values |
|----------|-----------------|
| `power` | `on`: LED is turned on<br>`off`: LED is turned off |
| `bright` | Brightness percentage, range 1-100 |
| `ct` | Color temperature, range 1700-6500 (K) |
| `rgb` | Color, range 1-16777215 |
| `hue` | Hue, range 0-359 |
| `sat` | Saturation, range 0-100 |
| `color_mode` | `1`: RGB mode<br>`2`: Color temperature mode<br>`3`: HSV mode |
| `flowing` | `0`: No flow is running<br>`1`: Color flow is running |
| `delayoff` | Remaining time of sleep timer, range 1-60 (minutes) |
| `flow_params` | Current flow parameters (only meaningful when `flowing` is `1`) |
| `music_on` | `1`: Music mode is on<br>`0`: Music mode is off |
| `name` | Device name (set by `set_name` command) |
| `bg_power` | Background light power status |
| `bg_flowing` | Background light is flowing |
| `bg_flow_params` | Current flow parameters of background light |
| `bg_ct` | Color temperature of background light |
| `bg_lmode` | `1`: RGB mode<br>`2`: Color temperature mode<br>`3`: HSV mode |
| `bg_bright` | Brightness percentage of background light |
| `bg_rgb` | Color of background light |
| `bg_hue` | Hue of background light |
| `bg_sat` | Saturation of background light |
| `nl_br` | Brightness of night mode light |
| `active_mode` | `0`: Daylight mode<br>`1`: Moonlight mode (ceiling light only) |

## Issues and Future Consideration

This specification will be updated if there are any changes to the Yeelight local control protocol.

## Reference

- **SSDP**: https://tools.ietf.org/html/draft-cai-ssdp-v1-03
- **JSON**: http://www.json.org/
